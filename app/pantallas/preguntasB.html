<script src="../js/pregunta.js"></script>
<script>
    //Navegacion principal
    let navegacion;
    let preguntas = document.createElement('div');
    let siguiente = document.createElement('button');
    siguiente.innerHTML = "Siguiente";
    siguiente.className = "btn_siguiente";

    let preguntas_total;
    preguntas.className = "preguntas";
    loadJson("../data/preguntas.1.json", (r) => {

        let con_preguntas = [];

        r.preguntas.forEach(p => {

            let opciones = [];

            p.opciones.forEach(o => {
                let opcion = new OpcionB(o.opcion, o.valor.categorias);
                opciones.push(opcion);
            });

            let obj_pregunta = new PreguntaB(p.pregunta, opciones);
            con_preguntas.push(new ContenidoA(obj_pregunta.getElement(), obj_pregunta));

        });

        preguntas_total = new Contenedor(con_preguntas);
        preguntas_total.foreachElementos(preguntas);

        navegacion = new Navegable(preguntas_total);

        $(".principal").append(preguntas, siguiente);

        navegacion.asignarCondiciones((e)=>{
            e.setValidacion(()=>{
                
                navegacion.siguiente(() => {
                
                preguntas_total.getObjectIndex(navegacion.actual).validar();
                
            }, () => {
                console.log("Finalizo");
                $(".principal").load("./pantallas/modulos/tarjetas.html");
            });

            });
        });
        

        siguiente.addEventListener('click', () => {


            navegacion.siguiente(() => {
                
                preguntas_total.getObjectIndex(navegacion.actual).validar();
                
            }, () => {
                console.log("Finalizo");
                $(".principal").load("./pantallas/modulos/tarjetas.html");
            });

        });
    });

</script>